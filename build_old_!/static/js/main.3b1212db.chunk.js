(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{112:function(e,t){},134:function(e,t,a){},258:function(e,t,a){e.exports=a(855)},263:function(e,t,a){},268:function(e,t,a){},793:function(e,t,a){},831:function(e,t,a){},833:function(e,t,a){},836:function(e,t,a){},855:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),s=a(71),r=a.n(s),i=a(65),c=(a(263),a(24)),l=a.n(c),u=a(41),d=a(36),m=a(37),p=a(39),h=a(38),g=a(40),f=a(60),b=a(72),v=(a(134),a(66)),w=a(47),y=(a(268),a(74)),E=(a(270),a(29)),S=a.n(E),k=a(50),C=(a(857),{aws_app_analytics:"enable",aws_bots:"enable",aws_bots_config:[{name:"social",alias:"$LATEST",description:"","bot-template":"bot-import","commands-help":[],region:"us-west-2"}],aws_cognito_identity_pool_id:"us-west-2:ac0dfac4-c424-4d5a-8cd5-42e026d16310",aws_cognito_region:"us-west-2",aws_content_delivery:"enable",aws_content_delivery_bucket:"reactchatbot-hosting-mobilehub-1744496812",aws_content_delivery_bucket_region:"us-west-2",aws_content_delivery_cloudfront:"enable",aws_content_delivery_cloudfront_domain:"dahwhtn86d4y9.cloudfront.net",aws_mobile_analytics_app_id:"b38cb95e8ab045128ade73d3c529923c",aws_mobile_analytics_app_region:"us-east-1",aws_project_id:"4379cc4c-ca1b-449c-8e64-8dc420f1adbe",aws_project_name:"react-chatbot-2018-12-16-20-43-53",aws_project_region:"us-west-2",aws_resource_name_prefix:"reactchatbot-mobilehub-1744496812",aws_sign_in_enabled:"enable",aws_user_pools:"enable",aws_user_pools_id:"us-west-2_8BYKNA1JH",aws_user_pools_mfa_type:"ON",aws_user_pools_web_client_id:"5q8j85sfo2k5rofuqrcjncttls"}),_=a(253),O=a.n(_),j={accessKeyId:"AKIAIXZQQFSFSDBBG7EA",secretAccessKey:"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",region:"us-west-2"};a(232);var x=function(e){function t(){var e,a;Object(d.a)(this,t);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(a=Object(p.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(o)))).responseFacebook=function(e){console.log(e),uid=e.id;var t=e.name,n=e.picture.data.url;console.log(n);var o={id:uid,name:t,picture:n};a.props.updateUsername(o),gresp=e},a}return Object(g.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return o.a.createElement(O.a,{appId:"121430428773899",autoLoad:!0,fields:"name,email,picture",scope:"public_profile,email, user_likes, user_photos, user_posts",callback:this.responseFacebook})}}]),t}(o.a.Component),A=(a(781),a(127)),L=a(232),N=function(e){function t(){var e,a;Object(d.a)(this,t);for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(a=Object(p.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(o)))).state={input:"",finalMessage:"",messages:[new k.Message({id:1,message:"How can I help you today?"})],id:"",name:"",picture:""},a._handleKeyPress=function(e){a.state.input;"Enter"===e.key&&a.submitMessage()},a.updateUsername=function(e){console.log(e),a.setState({id:e.id,name:e.name,picture:e.picture})},a.logout=function(){window.FB.logout(function(e){console.log("logged out")}),a.setState({id:""})},a}return Object(g.a)(t,e),Object(m.a)(t,[{key:"componentDidUpdate",value:function(){var e=this;if(this.state.id){var t=function(){a.style.color="#000",window.recorder.stop(),a.disabled=!1};navigator.mediaDevices.getUserMedia({audio:!0}).then(function(t){var a=window.recorder=new MediaRecorder(t),n=[];a.ondataavailable=function(e){n.push(e.data)},a.onerror=function(e){throw e.error||new Error(e.name)},a.onstart=function(e){n=[]},a.onstop=function(t){var a=new Blob(n,{type:"audio/x-l16"}),o=new FileReader;o.onload=function(){(new AudioContext).decodeAudioData(o.result,function(t){!function(e,t,a){var n=e.numberOfChannels,o=e.length*t/e.sampleRate,s=new OfflineAudioContext(n,o,t),r=s.createBufferSource();r.buffer=e,r.connect(s.destination),r.start(0),s.startRendering().then(function(e){a(e)})}(t,16e3,function(t){!function(t){console.log("in sendToServer");var a={botAlias:"lol",botName:"social",contentType:"audio/x-l16; sample-rate=16000; channel-count=1",inputStream:t,userId:"hello",accept:"audio/mpeg"};console.log(j),new L.LexRuntime(j).postContent(a,function(t,a){if(console.log("inpost"),t)console.log("ERROR!",t,t.stack);else{console.log("in else"),console.log(a),console.log(a.audioStream);var n=new Uint8Array(a.audioStream).buffer,o=new Blob([n]);console.log(o),URL.createObjectURL(o);var s=a.inputTranscript;if(""===s)return;var r=new k.Message({id:0,message:s}),i=[].concat(Object(y.a)(e.state.messages),[r]);e.setState({messages:i,input:""});var c=new k.Message({id:1,message:a.message}),l=a.message;i=[].concat(Object(y.a)(e.state.messages),[c]),e.setState({messages:i}),""!==l&&(l.includes("feed")&&I(gresp),l.includes("photo")&&F(),l.includes("like")&&B(gresp))}})}(function(e){for(var t=e.length,a=new Int16Array(t);t--;)a[t]=32767*Math.min(1,e[t]);return a.buffer}(t.getChannelData(0)))})})},o.readAsArrayBuffer(a)}}).catch(function(e){console.log(e.message)});var a=document.getElementsByClassName("record-it")[0];a.onclick=function(){setTimeout(function(){t()},3e3),a.style.color="#f00",a.disabled=!0,window.recorder.start()};var n=new L.CognitoIdentityCredentials({IdentityPoolId:"us-west-2:ac0dfac4-c424-4d5a-8cd5-42e026d16310"});new L.Config({credentials:n,accessKeyId:j.accessKeyId,secretAccessKey:j.secretAccessKey,region:j.region})}}},{key:"onChange",value:function(e){var t=e.target.value;this.setState({input:t})}},{key:"handleComplete",value:function(e,t){if(!e)return alert("Success: "+JSON.stringify(t,null,2)),"Reservation booked. Thank you! What would you like to do next?";alert("Bot conversation failed")}},{key:"submitMessage",value:function(){var e=Object(u.a)(l.a.mark(function e(){var t,a,n,o,s,r;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==(t=this.state.input)){e.next=3;break}return e.abrupt("return");case 3:return a=new k.Message({id:0,message:t}),n=[].concat(Object(y.a)(this.state.messages),[a]),this.setState({messages:n,input:""}),e.next=8,E.Interactions.send("social",t);case 8:o=e.sent,s=new k.Message({id:1,message:o.message}),r=o.message,n=[].concat(Object(y.a)(this.state.messages),[s]),this.setState({messages:n}),console.log(n),""!==r&&(r.includes("feed")&&I(gresp),r.includes("photo")&&F(),r.includes("like")&&B(gresp)),"Fulfilled"===o.dialogState&&o.intentName;case 16:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state.id;return o.a.createElement("div",{className:"App chatbot"},e?o.a.createElement("div",{className:"cont"},o.a.createElement("div",{style:P.messagesContainer,className:"lex"},o.a.createElement("img",{className:"img-responsive",src:this.state.picture}),o.a.createElement("p",{className:"w-text"},"Welcome ",this.state.name,"! ",o.a.createElement("button",{className:"btn logout-btn",onClick:this.logout},"Logout")),o.a.createElement("h2",null,this.state.finalMessage),o.a.createElement(k.ChatFeed,{messages:this.state.messages,hasInputField:!1,bubbleStyles:P.bubbleStyles}),o.a.createElement("input",{onKeyPress:this._handleKeyPress,onChange:this.onChange.bind(this),style:P.input,value:this.state.input,id:"lex-input"}),o.a.createElement("button",{className:"record-it"},o.a.createElement(A.a,{icon:"microphone"}))),o.a.createElement("div",{id:"record"})):o.a.createElement("div",null,o.a.createElement("p",{className:"w-text"},"Hey! Please log in to continue."),o.a.createElement(x,{username:e,updateUsername:this.updateUsername})))}}]),t}(n.Component);function I(e){window.FB.api("/me/feed",function(t){if(t&&!t.error){console.log("i am here before sqs");var a=new L.SQS(j);console.log("i am here in if"),console.log(t),t.resp=e;var n={MessageBody:JSON.stringify(t),QueueUrl:"https://sqs.us-west-2.amazonaws.com/457946912569/fb_app",MessageAttributes:{someKey:{DataType:"String",StringValue:"string"}}};a.sendMessage(n,function(e,t){console.log("i hereheheheheheheh"),e?console.log("error "+e.stack):console.log(t)}),function(){console.log("in fetchfromlambda"),console.log(uid);var e=new L.Lambda({accessKeyId:j.accessKeyId,secretAccessKey:j.secretAccessKey,region:j.region,apiVersion:"2015-03-31"}),t={FunctionName:"fetchfromdynamo",Payload:uid.toString()};e.invoke(t,function(e,t){if(e)console.log(e,e.stack);else{console.log("youydfsadgffdgn"),console.log(t);var a=JSON.stringify(t);console.log("this is a"),console.log(a),console.log(JSON.parse(a));var n=JSON.parse(a);console.log("this is b"),console.log(n.Payload);var o=JSON.parse(n.Payload);console.log(o.audio_link);var s=o.text;console.log(s);var r=document.createElement("audio");r.id="audio-player",r.controls="controls",r.src=o.audio_link,r.type="audio/mpeg";for(var i=document.getElementById("record");i.firstChild;)i.removeChild(i.firstChild);i.appendChild(r);try{r.play()}catch(e){console.log(e)}}})}(),console.log(t)}else console.log("i am here"),console.log(t.error)})}function F(){console.log("in fetchphotos"),window.FB.api("/me/photos?fields=images",function(e){if(e&&!e.error){console.log("fetchphotos in function resp");var t=e.data,a=0,n=[];for(console.log(t),a=0;a<t.length;a++)n[a]=t[a].images[0].source;for(var o=document.getElementById("record");o.firstChild;)o.removeChild(o.firstChild);var s=document.createElement("div");for(s.classList.add("fb-images"),a=0;a<n.length;a++){var r=document.createElement("img");r.classList.add("img-responsive"),r.classList.add("timeline"),r.src=n[a],r.height=100,r.width=100,s.appendChild(r)}o.appendChild(s)}else console.log(e.error)})}function B(e){window.FB.api("/me/likes",function(t){if(t&&!t.error){var a=new L.SQS(j);t.resp=e;var n={MessageBody:JSON.stringify(t),QueueUrl:"https://sqs.us-west-2.amazonaws.com/457946912569/social_likes",MessageAttributes:{someKey:{DataType:"String",StringValue:"string"}}};a.sendMessage(n,function(e,t){e?console.log("error "+e.stack):console.log(t)}),function(){var e=new L.Lambda({accessKeyId:j.accessKeyId,secretAccessKey:j.secretAccessKey,region:j.region,apiVersion:"2015-03-31"}),t={FunctionName:"fetchlikesfromdynamo",Payload:uid.toString()};e.invoke(t,function(e,t){if(e)console.log(e,e.stack);else{var a=JSON.stringify(t),n=JSON.parse(a),o=JSON.parse(n.Payload),s=(o.text,document.createElement("audio"));s.id="audio-player",s.controls="controls",s.src=o.audio_link,s.type="audio/mpeg";for(var r=document.getElementById("record");r.firstChild;)r.removeChild(r.firstChild);r.appendChild(s);try{s.play()}catch(e){console.log(e)}}})}()}else console.log(t.error)})}var P={bubbleStyles:{text:{fontSize:16},chatbubble:{borderRadius:30,padding:10}},headerTitle:{color:"white",fontSize:22},header:{backgroundColor:"rgb(0, 132, 255)",padding:20,borderTop:"12px solid rgb(204, 204, 204)"},messagesContainer:{display:"flex",flexDirection:"column",padding:10,alignItems:"center"},input:{fontSize:16,padding:10,outline:"none",width:350,border:"none",borderBottom:"2px solid rgb(0, 132, 255)"}},K=a(90),M=a(859),U=a(860),T=a(865),R=a(92),z=a(858),D=a(827),J=(a(793),function(e){var t=e.isLoading,a=e.text,n=e.loadingText,s=e.className,r=void 0===s?"":s,i=e.disabled,c=void 0!==i&&i,l=Object(R.a)(e,["isLoading","text","loadingText","className","disabled"]);return o.a.createElement(z.a,Object.assign({className:"LoaderButton ".concat(r),disabled:c||t},l),t&&o.a.createElement(D.a,{glyph:"refresh",className:"spinning"}),t?n:a)}),H=(a(831),function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(p.a)(this,Object(h.a)(t).call(this,e))).handleChange=function(e){a.setState(Object(K.a)({},e.target.id,e.target.value))},a.handleSubmit=function(){var e=Object(u.a)(l.a.mark(function e(t){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a.setState({isLoading:!0}),e.prev=2,e.next=5,E.Auth.signIn(a.state.email,a.state.password);case 5:a.props.userHasAuthenticated(!0),a.props.history.push("/"),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),a.setState({isLoading:!1});case 12:case"end":return e.stop()}},e,this,[[2,9]])}));return function(t){return e.apply(this,arguments)}}(),a.state={isLoading:!1,email:"",password:""},a}return Object(g.a)(t,e),Object(m.a)(t,[{key:"validateForm",value:function(){return this.state.email.length>0&&this.state.password.length>0}},{key:"render",value:function(){return o.a.createElement("div",{className:"Login"},o.a.createElement("form",{onSubmit:this.handleSubmit},o.a.createElement(M.a,{controlId:"email",bsSize:"large"},o.a.createElement(U.a,null,"Email"),o.a.createElement(T.a,{autoFocus:!0,type:"email",value:this.state.email,onChange:this.handleChange})),o.a.createElement(M.a,{controlId:"password",bsSize:"large"},o.a.createElement(U.a,null,"Password"),o.a.createElement(T.a,{value:this.state.password,onChange:this.handleChange,type:"password"})),o.a.createElement(J,{block:!0,bsSize:"large",disabled:!this.validateForm(),type:"submit",isLoading:this.state.isLoading,text:"Login",loadingText:"Logging in\u2026"})))}}]),t}(n.Component)),W=function(e){function t(){return Object(d.a)(this,t),Object(p.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return this.props.isAuthenticated?o.a.createElement(N,null):o.a.createElement(H,{props:this.props})}}]),t}(n.Component),V=(a(833),function(){return o.a.createElement("div",{className:"NotFound"},o.a.createElement("h3",null,"Sorry, page not found!"))}),Q=function(e){var t=e.component,a=e.props,n=Object(R.a)(e,["component","props"]);return o.a.createElement(w.a,Object.assign({},n,{render:function(e){return o.a.createElement(t,Object.assign({},e,a))}}))},q=a(861),G=(a(836),function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(p.a)(this,Object(h.a)(t).call(this,e))).handleChange=function(e){a.setState(Object(K.a)({},e.target.id,e.target.value))},a.handleSubmit=function(){var e=Object(u.a)(l.a.mark(function e(t){var n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a.setState({isLoading:!0}),e.prev=2,e.next=5,E.Auth.signUp({username:a.state.email,password:a.state.password});case 5:n=e.sent,a.setState({newUser:n}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),alert(e.t0.message);case 12:a.setState({isLoading:!1});case 13:case"end":return e.stop()}},e,this,[[2,9]])}));return function(t){return e.apply(this,arguments)}}(),a.handleConfirmationSubmit=function(){var e=Object(u.a)(l.a.mark(function e(t){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a.setState({isLoading:!0}),e.prev=2,e.next=5,E.Auth.confirmSignUp(a.state.email,a.state.confirmationCode);case 5:return e.next=7,E.Auth.signIn(a.state.email,a.state.password);case 7:a.props.userHasAuthenticated(!0),a.props.history.push("/"),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(2),alert(e.t0.message),a.setState({isLoading:!1});case 15:case"end":return e.stop()}},e,this,[[2,11]])}));return function(t){return e.apply(this,arguments)}}(),a.state={isLoading:!1,email:"",password:"",confirmPassword:"",confirmationCode:"",newUser:null},a}return Object(g.a)(t,e),Object(m.a)(t,[{key:"validateForm",value:function(){return this.state.email.length>0&&this.state.password.length>0&&this.state.password===this.state.confirmPassword}},{key:"validateConfirmationForm",value:function(){return this.state.confirmationCode.length>0}},{key:"renderConfirmationForm",value:function(){return o.a.createElement("form",{onSubmit:this.handleConfirmationSubmit},o.a.createElement(M.a,{controlId:"confirmationCode",bsSize:"large"},o.a.createElement(U.a,null,"Confirmation Code"),o.a.createElement(T.a,{autoFocus:!0,type:"tel",value:this.state.confirmationCode,onChange:this.handleChange}),o.a.createElement(q.a,null,"Please check your email for the code.")),o.a.createElement(J,{block:!0,bsSize:"large",disabled:!this.validateConfirmationForm(),type:"submit",isLoading:this.state.isLoading,text:"Verify",loadingText:"Verifying\u2026"}))}},{key:"renderForm",value:function(){return o.a.createElement("form",{onSubmit:this.handleSubmit},o.a.createElement(M.a,{controlId:"email",bsSize:"large"},o.a.createElement(U.a,null,"Email"),o.a.createElement(T.a,{autoFocus:!0,type:"email",value:this.state.email,onChange:this.handleChange})),o.a.createElement(M.a,{controlId:"password",bsSize:"large"},o.a.createElement(U.a,null,"Password"),o.a.createElement(T.a,{value:this.state.password,onChange:this.handleChange,type:"password"})),o.a.createElement(M.a,{controlId:"confirmPassword",bsSize:"large"},o.a.createElement(U.a,null,"Confirm Password"),o.a.createElement(T.a,{value:this.state.confirmPassword,onChange:this.handleChange,type:"password"})),o.a.createElement(J,{block:!0,bsSize:"large",disabled:!this.validateForm(),type:"submit",isLoading:this.state.isLoading,text:"Signup",loadingText:"Signing up\u2026"}))}},{key:"render",value:function(){return o.a.createElement("div",{className:"Signup"},null===this.state.newUser?this.renderForm():this.renderConfirmationForm())}}]),t}(n.Component)),X=function(e){var t=e.childProps;return o.a.createElement(v.a,null,o.a.createElement(Q,{path:"/",exact:!0,component:W,props:t}),o.a.createElement(Q,{path:"/index.html",exact:!0,component:W,props:t}),o.a.createElement(Q,{path:"/login",exact:!0,component:H,props:t}),o.a.createElement(Q,{path:"/signup",exact:!0,component:G,props:t}),o.a.createElement(w.a,{component:V}))},Z=a(864),$=a(862),Y=a(863),ee=a(130),te=a(61),ae=a(131);te.b.add(ae.a),te.b.add(ae.b);var ne=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(p.a)(this,Object(h.a)(t).call(this,e))).userHasAuthenticated=function(e){a.setState({isAuthenticated:e})},a.handleLogout=function(){var e=Object(u.a)(l.a.mark(function e(t){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.Auth.signOut();case 2:a.userHasAuthenticated(!1),a.props.history.push("/login");case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),a.state={isAuthenticated:!1,isAuthenticating:!0},a}return Object(g.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=Object(u.a)(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,E.Auth.currentSession();case 3:this.userHasAuthenticated(!0),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),"No current user"!==e.t0&&alert(e.t0);case 9:this.setState({isAuthenticating:!1});case 10:case"end":return e.stop()}},e,this,[[0,6]])}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e={isAuthenticated:this.state.isAuthenticated,userHasAuthenticated:this.userHasAuthenticated};return!this.state.isAuthenticating&&o.a.createElement("div",{className:"App container"},o.a.createElement(Z.a,{fluid:!0,collapseOnSelect:!0},o.a.createElement(Z.a.Header,null,o.a.createElement(Z.a.Brand,null,o.a.createElement(f.a,{to:"/"},"Social Media Radio")),o.a.createElement(Z.a.Toggle,null)),o.a.createElement(Z.a.Collapse,null,o.a.createElement($.a,{pullRight:!0},this.state.isAuthenticated?o.a.createElement(Y.a,{onClick:this.handleLogout},"Logout"):o.a.createElement(n.Fragment,null,o.a.createElement(ee.LinkContainer,{to:"/signup"},o.a.createElement(Y.a,null,"Signup")),o.a.createElement(ee.LinkContainer,{to:"/login"},o.a.createElement(Y.a,null,"Login")))))),o.a.createElement(X,{childProps:e}))}}]),t}(n.Component),oe=Object(b.a)(ne),se=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function re(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}S.a.configure(C),r.a.render(o.a.createElement(i.a,null,o.a.createElement(oe,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("","/service-worker.js");se?(function(e,t){fetch(e).then(function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):re(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")})):re(t,e)})}}()},99:function(e,t){}},[[258,2,1]]]);
//# sourceMappingURL=main.3b1212db.chunk.js.map